# ======================================================================================================================
# Author: Sam Dunham (sdunham@nvidia.com)
# ======================================================================================================================

# ======================================================================================================================
# Built-in modules
# ======================================================================================================================
import logging

# ======================================================================================================================
# Third party modules
# ======================================================================================================================
import uvicorn

# ======================================================================================================================
# Custom Module imports
# ======================================================================================================================
from .webapp import initialize_web_app
from .config import auth_settings
from .apis import (
    authenticated_router,
    no_auth_router,
    system_health_router,
    )

# ======================================================================================================================
# Logging configuration
# ======================================================================================================================
LOGGER = logging.getLogger(__name__)
LOGGER.setLevel(logging.DEBUG)

# ======================================================================================================================
# Module level objects
# ======================================================================================================================
routers = [authenticated_router,
           no_auth_router,
           system_health_router]

app = initialize_web_app(routers, auth_settings)


# ======================================================================================================================
# Entry points for running the applications
# ======================================================================================================================
def start():
    """Launched with `poetry run start` at root level"""
    uvicorn.run("app.src.main:app", host="0.0.0.0", port=3000, reload=True)
